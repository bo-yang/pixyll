---
layout: post
title: 关于属性页和属性单的应用总结
categories: 
- MFC
tags: 
- C/C++
status: publish
type: post
published: true
meta:
  views: '355'
  original_post_id: '16'
  _wp_old_slug: '16'
author: 
---

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;关于属性页和属性单的应用总结</p>
<p>1、属性页(CPropertyPage)中获取<br />&nbsp;(1) 程序主框架指针：CMainFrame* pMainFrame=(CMainFrame*)AfxGetMainWnd();<br />&nbsp;(2) 程序子框架指针：CChildFrame* pframe=(CChildFrame*)((CMainFrame*)AfxGetMainWnd())-&gt;GetActiveFrame();<br />&nbsp;(3) 程序活动文档指针：CEMCDoc* m_pDoc=(CEMCDoc*)pframe-&gt;GetActiveDocument();&nbsp;//获取活动的文档<br />&nbsp;(4) 属性单(CPropertySheet)指针：CMyPropertySheet* pSheet=(CMyPropertySheet*)this-&gt;GetParent();&nbsp;// 获取CMyPropertySheet指针<br />&nbsp;(5) 程序活动视图指针：CEMCView* pView=(CEMCView*)pframe-&gt;GetActiveView();&nbsp;// 获取活动视图</p>
<p>2、在属性单(CPropertySheet)单击OK按钮后，程序框架将逐个遍历加载的CPropertyPage（从GetPage(0)～GetPage(N-1)），查询是否<br />有CPropertyPage重载了OnOK()，若有则执行重载的代码，否则执行默认的CPropertyPage::OnOK()。</p>
<p>3、CPropertySheet和加载的CPropertyPage通信，可以在CPropertySheet中定义<br />&nbsp;CPPageContentMode* pCM=(CPPageContentMode*)this-&gt;GetPage(0);<br />&nbsp;然后利用pCM操作CPPageContentMode中的成员变量。<br />&nbsp;也可以在CPropertyPage中获取CPropertySheet的指针。</p>
<p>4、两个或多个加载的CPropertyPage之间通信，可以借助于CPropertySheet实现。</p>
<p>5、对CPropertySheet标准按钮的操作<br />&nbsp;(1)更改标准按钮的标题：<br />&nbsp;CWnd* pWnd=GetDlgItem(IDOK);<br />&nbsp;pWnd-&gt;SetWindowTextW(_T(&quot;开始&quot;));<br />&nbsp;(2)去掉&ldquo;应用&rdquo;按钮：<br />&nbsp;pWnd=GetDlgItem(ID_APPLY_NOW);<br />&nbsp;pWnd-&gt;ShowWindow(FALSE);<br />&nbsp;(3)移动标准按钮至对话框中间</p>
<div style="border-right:windowtext .5pt solid;border-top:windowtext .5pt solid;background:#e6e6e6;border-left:windowtext .5pt solid;width:95%;word-break:break-all;border-bottom:windowtext .5pt solid;padding:4px 5.4pt;">
<div><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><span style="color:#000000;">CPropertyPage</span><span style="color:#000000;">*</span><span style="color:#000000;">&nbsp;pPage;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;pPage</span><span style="color:#000000;">=</span><span style="color:#0000ff;">this</span><span style="color:#000000;">-&gt;</span><span style="color:#000000;">GetPage(</span><span style="color:#000000;">0</span><span style="color:#000000;">);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="color:#008000;">//</span><span style="color:#008000;">&nbsp;CRect&nbsp;rectPage;</span><span style="color:#008000;"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="color:#000000;">&nbsp;pPage</span><span style="color:#000000;">-&gt;</span><span style="color:#000000;">GetWindowRect(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectPage);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;CWnd</span><span style="color:#000000;">*</span><span style="color:#000000;">&nbsp;pWndOK</span><span style="color:#000000;">=</span><span style="color:#000000;">GetDlgItem(IDOK);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;CWnd</span><span style="color:#000000;">*</span><span style="color:#000000;">&nbsp;pWndCancel</span><span style="color:#000000;">=</span><span style="color:#000000;">GetDlgItem(IDCANCEL);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;CRect&nbsp;rectOK,rectCancel;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;pWndOK</span><span style="color:#000000;">-&gt;</span><span style="color:#000000;">GetWindowRect(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectOK);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;pWndCancel</span><span style="color:#000000;">-&gt;</span><span style="color:#000000;">GetWindowRect(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectCancel);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;</span><span style="color:#0000ff;">int</span><span style="color:#000000;">&nbsp;BtnCenter</span><span style="color:#000000;">=</span><span style="color:#000000;">(rectCancel.right</span><span style="color:#000000;">-</span><span style="color:#000000;">rectOK.left)</span><span style="color:#000000;">/</span><span style="color:#000000;">2</span><span style="color:#000000;">;&nbsp;</span><span style="color:#008000;">//</span><span style="color:#008000;">&nbsp;OK和CANCEL按钮中轴线</span><span style="color:#008000;"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">int</span><span style="color:#000000;">&nbsp;PageCenter</span><span style="color:#000000;">=</span><span style="color:#000000;">(rectPage.right</span><span style="color:#000000;">-</span><span style="color:#000000;">rectPage.left)</span><span style="color:#000000;">/</span><span style="color:#000000;">2</span><span style="color:#000000;">;&nbsp;</span><span style="color:#008000;">//</span><span style="color:#008000;">属性单的中轴线</span><span style="color:#008000;"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">int</span><span style="color:#000000;">&nbsp;dist</span><span style="color:#000000;">=</span><span style="color:#000000;">PageCenter</span><span style="color:#000000;">-</span><span style="color:#000000;">BtnCenter;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;rectOK.left</span><span style="color:#000000;">+=</span><span style="color:#000000;">dist;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;rectOK.right</span><span style="color:#000000;">+=</span><span style="color:#000000;">dist;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;rectCancel.left</span><span style="color:#000000;">+=</span><span style="color:#000000;">dist;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;rectCancel.right</span><span style="color:#000000;">+=</span><span style="color:#000000;">dist;&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;ScreenToClient(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectOK);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;ScreenToClient(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectCancel);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;pWndOK</span><span style="color:#000000;">-&gt;</span><span style="color:#000000;">MoveWindow(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectOK);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />&nbsp;pWndCancel</span><span style="color:#000000;">-&gt;</span><span style="color:#000000;">MoveWindow(</span><span style="color:#000000;">&amp;</span><span style="color:#000000;">rectCancel);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span></div>
</div>
