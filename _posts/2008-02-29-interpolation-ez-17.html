---
layout: post
title: 关于ROHDE SCHWARZ公司电流探头EZ-17系数修正的说明
categories: 
- EMC
tags: 
- EMC
status: publish
type: post
published: true
meta:
  views: '490'
  original_post_id: '19'
  _wp_old_slug: '19'
author: 
---

<p align="center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关于EZ-17探头系数修正的说明</p>
<p>///// 电流探头EZ17测试结果修正&nbsp;/////<br />// 根据ROHDE&amp;SCHWARZ公司的手册，EZ17的测试结果需要<br />// 进行修正，加上转移电阻K。由手册给出的曲线(第二页)<br />// 和测试数据(第12页，表4-1),可知在对数坐标中，500KHz<br />// 以下可看作一条直线；500KHz～10MHz为一非线性变化段；<br />// 10MHz～200MHz为另一非线性变化段。据此，对测试数据进行<br />// 校正。以下所有拟合函数均为对数坐标系下的拟合函数。<br />//<br />// 20Hz～500KHz拟合函数为：<br />//&nbsp;&nbsp;p1=-19.1838*x-8.1953<br />// 500KHz～10MHz拟合函数为：<br />//&nbsp;&nbsp;p4=18.2253*x^4-31.3557*x^3+16.5565*x^2-6.6261*x-6.8<br />// 10MHz～20MHz拟合函数为：<br />//&nbsp;&nbsp;p0=-10<br />//&nbsp;20MHz～100MHz拟合函数为：<br />//&nbsp;&nbsp;p2=0.1157*x^2-0.0959*x-10.0711<br />// 100MHz～200MHz拟合函数为：<br />//&nbsp;&nbsp;p3=175.6*x^3-1044.5*x^2+2067.7*x-1371.9<br />//&nbsp;以上各式中，x为频率的对数，p为频率所对应的修正因子。<br />//</p>
<p>&nbsp;</p>
<div style="border-right:windowtext .5pt solid;border-top:windowtext .5pt solid;background:#e6e6e6;border-left:windowtext .5pt solid;width:95%;word-break:break-all;border-bottom:windowtext .5pt solid;padding:4px 5.4pt;">
<div><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><span style="color:#008000;">//</span><span style="color:#008000;">&nbsp;参数freq为频率，单位MHz。<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="color:#008000;">//</span><span style="color:#008000;">&nbsp;</span><span style="color:#008000;"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="color:#0000ff;">double</span><span style="color:#000000;">&nbsp;CEMCView::EZ17CorrectionFactor(</span><span style="color:#0000ff;">double</span><span style="color:#000000;">&nbsp;freq)<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif" /><img style="display:none;" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif" /></span><span id="_75_600_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;display:none;border-left:#808080 1px solid;border-bottom:#808080 1px solid;background-color:#ffffff;">...</span><span id="_75_600_Open_Text"><span style="color:#000000;">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">double</span><span style="color:#000000;">&nbsp;factor;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(freq</span><span style="color:#000000;">&gt;=</span><span style="color:#000000;">0.000020</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">&amp;&amp;</span><span style="color:#000000;">&nbsp;freq</span><span style="color:#000000;">&lt;=</span><span style="color:#000000;">0.5</span><span style="color:#000000;">)<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor</span><span style="color:#000000;">=-</span><span style="color:#000000;">19.1838</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">-</span><span style="color:#000000;">8.1953</span><span style="color:#000000;">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(freq</span><span style="color:#000000;">&gt;</span><span style="color:#000000;">0.5</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">&amp;&amp;</span><span style="color:#000000;">&nbsp;freq</span><span style="color:#000000;">&lt;</span><span style="color:#000000;">10</span><span style="color:#000000;">)<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor</span><span style="color:#000000;">=</span><span style="color:#000000;">18.2253</span><span style="color:#000000;">*</span><span style="color:#000000;">pow(log10(freq),</span><span style="color:#000000;">4</span><span style="color:#000000;">)</span><span style="color:#000000;">-</span><span style="color:#000000;">31.3557</span><span style="color:#000000;">*</span><span style="color:#000000;">pow(log10(freq),</span><span style="color:#000000;">3</span><span style="color:#000000;">)</span><span style="color:#000000;">+</span><span style="color:#000000;">16.5565</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">-</span><span style="color:#000000;">6.6261</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">-</span><span style="color:#000000;">6.8</span><span style="color:#000000;">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(freq</span><span style="color:#000000;">&gt;=</span><span style="color:#000000;">10</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">&amp;&amp;</span><span style="color:#000000;">&nbsp;freq</span><span style="color:#000000;">&lt;=</span><span style="color:#000000;">20</span><span style="color:#000000;">)<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor</span><span style="color:#000000;">=-</span><span style="color:#000000;">10.0</span><span style="color:#000000;">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(freq</span><span style="color:#000000;">&gt;</span><span style="color:#000000;">20</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">&amp;&amp;</span><span style="color:#000000;">&nbsp;freq</span><span style="color:#000000;">&lt;=</span><span style="color:#000000;">100</span><span style="color:#000000;">)<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor</span><span style="color:#000000;">=</span><span style="color:#000000;">0.1157</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">-</span><span style="color:#000000;">0.0959</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">-</span><span style="color:#000000;">10.0711</span><span style="color:#000000;">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">else</span><span style="color:#000000;">&nbsp;</span><span style="color:#0000ff;">if</span><span style="color:#000000;">(freq</span><span style="color:#000000;">&gt;</span><span style="color:#000000;">100</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">&amp;&amp;</span><span style="color:#000000;">&nbsp;freq</span><span style="color:#000000;">&lt;=</span><span style="color:#000000;">200</span><span style="color:#000000;">)<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor</span><span style="color:#000000;">=</span><span style="color:#000000;">175.6</span><span style="color:#000000;">*</span><span style="color:#000000;">pow(log10(freq),</span><span style="color:#000000;">3</span><span style="color:#000000;">)</span><span style="color:#000000;">-</span><span style="color:#000000;">1044.5</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">+</span><span style="color:#000000;">2067.7</span><span style="color:#000000;">*</span><span style="color:#000000;">log10(freq)</span><span style="color:#000000;">-</span><span style="color:#000000;">1371.9</span><span style="color:#000000;">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#0000ff;">return</span><span style="color:#000000;">&nbsp;factor;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif" />}</span></span></div>
</div>
